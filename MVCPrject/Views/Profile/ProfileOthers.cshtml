@model MVCPrject.Models.User

@{
  ViewData["Title"] = $"{Model?.Name ?? "User"}'s Profile";
}

<meta name="profile-user-id" content="@Model?.Id" />
<meta name="profile-user-email" content="@Model?.UserName" />
<meta name="current-user-email" content="@(User.Identity?.Name ?? "")" />
<meta name="user-authenticated" content="@User.Identity.IsAuthenticated" />

@section Styles {
    <link rel="stylesheet" href="~/css/profileOthers.css" />
}

@section Scripts {
  <script src="https://unpkg.com/feather-icons"></script>
  <script src="~/js/mealPlanner.js" asp-append-version="true"></script>
  <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
  <script src="~/js/profileOthers.js"></script>
}

<!-- Header Navigation -->
<div class="p-4 d-flex justify-content-between align-items-center bg-white shadow-sm">
    <a href="javascript:history.back()" 
       class="btn rounded-circle shadow-sm d-flex align-items-center justify-content-center"
       style="width: 48px; height: 48px; background-color: #e0e0e0;">
        <i data-feather="chevron-left" style="width: 20px; height: 20px;"></i>
    </a>
    <h2 class="mb-0 fw-bold">Profile</h2>
    <div class="d-flex align-items-center gap-3">
        @if (User.Identity?.IsAuthenticated == true)
        {
            <span class="text-muted">Welcome, @(User.Identity?.Name ?? "Guest")</span>
        }
        <img src="~/img/image.png" alt="Current User" class="border rounded-pill" style="width: 40px; height: 40px;">
    </div>
</div>

<!-- Profile Section -->
<div class="container-fluid py-5 bg-light">
  <div class="container">
    <div class="row align-items-center">
      <!-- Profile Image -->
      <div class="col-auto">
        <div class="position-relative">
          <img src="~/img/image.png" class="rounded-circle shadow-lg border border-4 border-white" 
               alt="@(Model?.Name ?? "User")'s profile" width="200" height="200">
          <div class="position-absolute bottom-0 end-0 bg-success rounded-circle border border-3 border-white" 
               style="width: 40px; height: 40px;" title="Online"></div>
        </div>
      </div>

      <!-- Profile Info -->
      <div class="col-md-8 ms-4">
        <div class="d-flex justify-content-between align-items-start flex-wrap mb-3">
          <div>
            <h1 class="fw-bold mb-2 display-6">@(Model?.Name ?? "Unknown User")</h1>
            <p class="text-muted fs-5 mb-0">@@@(Model?.UserName ?? "unknown")</p>
            <p class="text-secondary mt-2 mb-0">
              <i data-feather="calendar" class="me-2" style="width: 16px; height: 16px;"></i>
              Joined @DateTime.Now.ToString("MMMM yyyy")
            </p>
          </div>
          
          <!-- Action Buttons -->
          <div class="d-flex align-items-center gap-3">
            @if (User.Identity?.IsAuthenticated == true)
            {
              <button id="followBtn" class="btn btn-custom-red btn-lg px-4 py-2 shadow-sm" onclick="toggleFollow()" disabled>
                <span id="followText">
                  <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
                  Loading...
                </span>
              </button>
              <button class="btn btn-outline-secondary btn-lg" title="Message">
                <i data-feather="message-circle" style="width: 20px; height: 20px;"></i>
              </button>
              <button class="btn btn-outline-secondary btn-lg" title="More options">
                <i data-feather="more-horizontal" style="width: 20px; height: 20px;"></i>
              </button>
            }
            else
            {
              <a href="/Landing/Login" class="btn btn-custom-red btn-lg px-4 py-2 shadow-sm">
                Login to Follow
              </a>
            }
          </div>
        </div>

        <!-- Bio Section -->
        <div class="mb-4">
          <p class="fs-6 text-dark mb-3">
            üç≥ Passionate home cook sharing delicious recipes and culinary adventures. 
            Love experimenting with flavors from around the world!
          </p>
        </div>

        <!-- Stats Section -->
        <div class="row g-4 mb-4">
          <div class="col-md-4">
            <div class="text-center p-3 bg-white rounded-3 shadow-sm">
              <h3 class="fw-bold text-primary mb-1" id="recipeCount">
                <span class="spinner-border spinner-border-sm" role="status"></span>
              </h3>
              <p class="text-muted mb-0 fw-medium">Recipes</p>
            </div>
          </div>
          <div class="col-md-4">
            <div class="text-center p-3 bg-white rounded-3 shadow-sm">
              <h3 class="fw-bold text-success mb-1" id="followerCount">
                <span class="spinner-border spinner-border-sm" role="status"></span>
              </h3>
              <p class="text-muted mb-0 fw-medium">Followers</p>
            </div>
          </div>
          <div class="col-md-4">
            <div class="text-center p-3 bg-white rounded-3 shadow-sm">
              <h3 class="fw-bold text-info mb-1" id="followingCount">
                <span class="spinner-border spinner-border-sm" role="status"></span>
              </h3>
              <p class="text-muted mb-0 fw-medium">Following</p>
            </div>
          </div>
        </div>

        <!-- Social Links -->
        <div class="d-flex gap-3">
          <a href="#" class="btn btn-outline-dark btn-sm" title="Website">
            <i data-feather="link-2" class="me-2" style="width: 16px; height: 16px;"></i>
            Website
          </a>
          <a href="#" class="btn btn-outline-danger btn-sm" title="YouTube">
            <i data-feather="youtube" class="me-2" style="width: 16px; height: 16px;"></i>
            YouTube
          </a>
          <a href="#" class="btn btn-outline-primary btn-sm" title="Instagram">
            <i data-feather="instagram" class="me-2" style="width: 16px; height: 16px;"></i>
            Instagram
          </a>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Content Tabs -->
<div class="container-fluid bg-white border-top">
  <div class="container">
    <nav class="nav nav-tabs border-0 pt-4" id="profileTabs" role="tablist">
      <button class="nav-link active fw-bold text-dark border-0 border-bottom border-3 border-primary" 
              id="recipes-tab" data-bs-toggle="tab" data-bs-target="#recipes" type="button" role="tab">
        <i data-feather="book-open" class="me-2" style="width: 18px; height: 18px;"></i>
        Recipes
      </button>
      <button class="nav-link fw-bold text-muted border-0" 
              id="favorites-tab" data-bs-toggle="tab" data-bs-target="#favorites" type="button" role="tab">
        <i data-feather="heart" class="me-2" style="width: 18px; height: 18px;"></i>
        Favorites
      </button>
      <button class="nav-link fw-bold text-muted border-0" 
              id="reviews-tab" data-bs-toggle="tab" data-bs-target="#reviews" type="button" role="tab">
        <i data-feather="star" class="me-2" style="width: 18px; height: 18px;"></i>
        Reviews
      </button>
    </nav>
  </div>
</div>

<!-- Tab Content -->
<div class="container-fluid py-4">
  <div class="container">
    <div class="tab-content" id="profileTabsContent">
      <!-- Recipes Tab -->
      <div class="tab-pane fade show active" id="recipes" role="tabpanel">
        <div class="row" id="recipesContainer">
          <div class="col-12 text-center py-5">
            <div class="spinner-border text-primary" role="status">
              <span class="visually-hidden">Loading recipes...</span>
            </div>
            <p class="text-muted mt-3">Loading recipes...</p>
          </div>
        </div>
      </div>
      
      <!-- Favorites Tab -->
      <div class="tab-pane fade" id="favorites" role="tabpanel">
        <div class="text-center py-5">
          <i data-feather="heart" style="width: 64px; height: 64px;" class="text-muted mb-3"></i>
          <h4 class="text-muted">No favorites yet</h4>
          <p class="text-muted">Favorite recipes will appear here</p>
        </div>
      </div>
      
      <!-- Reviews Tab -->
      <div class="tab-pane fade" id="reviews" role="tabpanel">
        <div class="text-center py-5">
          <i data-feather="star" style="width: 64px; height: 64px;" class="text-muted mb-3"></i>
          <h4 class="text-muted">No reviews yet</h4>
          <p class="text-muted">Recipe reviews will appear here</p>
        </div>
      </div>
    </div>
  </div>
</div>


<style>
.btn-custom-red {
    background-color: #EC433E;
    border-color: #EC433E;
    color: white;
    transition: all 0.3s ease;
}

.btn-custom-red:hover {
    background-color: #d73527;
    border-color: #d73527;
    color: white;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(236, 67, 62, 0.3);
}

.btn-outline-danger:hover {
    background-color: #dc3545;
    border-color: #dc3545;
    color: white;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(220, 53, 69, 0.3);
}

.nav-tabs .nav-link.active {
    border-bottom: 3px solid #EC433E !important;
    color: #EC433E !important;
}

.nav-tabs .nav-link:hover {
    color: #EC433E;
    border-bottom: 3px solid transparent;
}

.bg-light {
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%) !important;
}

.shadow-lg {
    box-shadow: 0 1rem 3rem rgba(0, 0, 0, 0.175) !important;
}

.card-hover {
    transition: all 0.3s ease;
}

.card-hover:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
}

.spinner-border-sm {
    width: 1rem;
    height: 1rem;
}

@@keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

.fade-in {
    animation: fadeIn 0.5s ease-out;
}

.toast-container {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 9999;
}

.profile-stats {
    transition: all 0.3s ease;
}

.profile-stats:hover {
    transform: scale(1.05);
}
</style>